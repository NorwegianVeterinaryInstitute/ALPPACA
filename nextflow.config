// Singularity image paths for each process
process {
	withName: PARSNP {
		container = "docker://biocontainers/parsnp:v1.2dfsg-5-deb_cv1"
	}
	withName: SNIPPY {
		container = "https://depot.galaxyproject.org/singularity/snippy:4.6.0--hdfd78af_1"
	}
        withName: PANAROO_PANGENOME {
                container = "https://depot.galaxyproject.org/singularity/panaroo:1.2.9--pyhdfd78af_0"
        }
	withName: PANAROO_QC {
		container = "https://depot.galaxyproject.org/singularity/panaroo:1.2.9--pyhdfd78af_0"
	}
	withName: IQTREE {
		container = "https://depot.galaxyproject.org/singularity/iqtree:2.1.4_beta--hdcc8f71_0"
	}
        withName: IQTREE_FCONST {
                container = "https://depot.galaxyproject.org/singularity/iqtree:2.1.4_beta--hdcc8f71_0"
        }
	withName: GUBBINS {
		container = "https://depot.galaxyproject.org/singularity/gubbins:3.1.3--py38h390ddb8_0"
	}
	withName: MASKRC {
		container = "https://depot.galaxyproject.org/singularity/maskrc-svg:0.5--1"
	}
	withName: PROKKA {
		container = "https://depot.galaxyproject.org/singularity/prokka:1.14.6--pl5262hdfd78af_1"
	}
	withName: DEDUPLICATE {
		container = "https://depot.galaxyproject.org/singularity/seqkit:2.1.0--h9ee0642_0"
	}
	withName: SNPDIST {
		container = "https://depot.galaxyproject.org/singularity/snp-dists:0.8.2--h5bf99c6_0"
	}
	withName: SNPSITES {
		container = "https://depot.galaxyproject.org/singularity/snp-sites:2.5.1--h5bf99c6_1"
	}
        withName: SNPSITES_FCONST {
                container = "https://depot.galaxyproject.org/singularity/snp-sites:2.5.1--h5bf99c6_1"
        }
	withName: GENTREE {
		container = "library://hkaspersen/default/r_base_4.1.2_ggtree_3.2.1:latest"
	}
}

// Singularity options
profiles {
	singularity {
        	singularity.enabled	= true
		singularity.autoMounts 	= true
		singularity.cacheDir	= "$USERWORK/singularity"
	}
}

// SLURM options
process {
	executor = 'slurm'
	clusterOptions = '--job-name=ALPPACA --account=nn9305k --mem-per-cpu=4700M'
	queueSize = 24
	maxRetries = 2
	errorStrategy='retry'

	cpus = 4
	withLabel: medium {cpus = 8}
	withLabel: heavy {cpus = 20}

	withLabel: bigmem {
		cpus = 8
		clusterOptions = '--job-name=ALPPACA --account=nn9305k --partition=bigmem --mem-per-cpu=32000M'
	}

	time = { 8.h * task.attempt }
	
	withLabel: shorttime {
		time = { 1.h * task.attempt }
		cpus = 1
	}

	withLabel: longtime {
		time = { 48.h * task.attempt }
		cpus = 8
	}
}

params.module_dir	= '../modules'
params.workflow_dir	= './workflows'
