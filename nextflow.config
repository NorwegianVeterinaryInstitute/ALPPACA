// Specify minimum nextflow version
nextflowVersion = ">=21.10.6"

report {
	enabled					= true
	file					= "${params.out_dir}/logs/nextflow_run_report.html"
}

// Profiles
profiles {
	local {
		singularity.enabled		= true
		singularity.autoMounts		= true
		process {
			executor	 	= 'local'
			errorStrategy		= 'retry'
			maxRetries		= 2
			time			= {8.h * task.attempt}
			cpus			= 4
		}
	}
	
	cluster{
		singularity.enabled		= true
        	singularity.autoMounts		= true
		process {
			executor = 'slurm'
        		clusterOptions = '--job-name=ALPPACA --account=nn9305k --mem-per-cpu=4700M'
        		queueSize = 24
			errorStrategy='retry'
        		maxRetries = 2
        		time = {8.h * task.attempt}
        		cpus = 4
	
			withLabel: medium {
                		cpus = 8
        		}

        		withLabel: heavy {
                		cpus = 20
        		}

        		withLabel: bigmem {
                		cpus = 8
                		clusterOptions = '--job-name=ALPPACA --account=nn9305k --partition=bigmem --mem-per-cpu=32000M'
        		}

        		withLabel: bigmem_gubbins {
                		time = { 48.h * task.attempt }
                		cpus = 8
                		clusterOptions = '--job-name=ALPPACA --account=nn9305k --partition=bigmem --mem-per-cpu=32000M'
        		}

        		withLabel: shorttime {
                		time = { 1.h * task.attempt }
                		cpus = 1
        		}

        		withLabel: longtime {
                		time = { 48.h * task.attempt }
                		cpus = 8
        		}
		}
	}
}

params.module_dir	= "../modules"
params.workflow_dir	= "./workflows"
